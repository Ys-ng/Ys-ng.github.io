---
layout: post
title: 이더리움 (ethereum)
subtitle: blockchain ethereum
categories: BlockChain
tags: [ethereum, blockchain]
---




## 이더리움이란

* 프로그래밍한 대로 정확히 작동하는 스마트 컨트랙트를 작동시키는 탈중앙화된 플랫폼
* 블록체인 내부의 이더리움 가상머신 운영체제와 스마트 컨트랙트 개발언어, 이를 작동하고 관리하기위한 다양한 서비스를 제공


로드맵(2017년 이더리움재단에서 제시)
1단계 프런티어 : 






### 스마트 컨트랙스
* 1996년 닉 스자보(Nick Szabo)의 논문에 의해 처음으로 개념화
* 넓은 의미의 스마트 계약
 -> 여떠한 다운타임, 검열, 사기행위, 제3자간섭없이 프로그래밍된 대로 정확히 **실행**되는 프로그램
* 블록체인의 스마트 계약
* 솔리디티, LLL, Serpent를 비롯한 여러가지 언어로 작성가능

**장점**
* 거래상대를 신뢰하지않아도 거래에 문제가 발생하지 않는다
* 중재자가 필요없으므로 비용을 절감할수있다



## Account
* 모든 트랜잭션의 실행 주체이자 기본단위
* 모든 것은 어카운트에서 시작

**EOA** (Externally Owned Account: 외부소유계정)
* 사용자가 사용하는 계정
* 사용자가 자신의 개인키로 관리
* 개인키를 사용하여 전자서명된 트랜잭션을 생성하고 실행함으로써 메세지를 전송
* 이더를 송금하거나 계약을 실행할수있음
* 스마트 컨트랙트 실행 코드를 가지지 않음

**CA** (Contract Account: 계약계정)
* 스마트 컨트랙트
* 스마트 컨트랙트를 블록체인에 배포할떄 만들어지는 계정
* 개인키는 없음
* 다른 CA나 EOA로부터 메시지를 수신해 코드를 실행하고 메시지를 보낼수있음


책추천: 코어 이더리움 프로그래밍 /박재현
영어 원문: https://github.com/ethereumbook/ethereumbook

```go
// go-ethereum
tyep Account struct{
	Nonce uin64    //해당계정으로부터 보내진 트랜잭션 수
		        //EOA에서는 거래를, CA에서는 계약에서 계약을 생성할때마다 1씩 증가
	Balance *big.Int //해당계정의 이더 잔고 (단위:Wei)
	Root common.Hash//해당계정이 저장될 스토리지의 머클 패트리시아 트리의 루트노드
	CodeHash []byte //해당계정의 스마트 컨트랙트 바이트 코드의 해시 (nil인경우 EOA를 의미)
}
```

### 트랜잭션
* 다른어카운트로 보낼 데이터 구조체로 전자서명으로 암호화
* 트랜잭션의 발신자는 ECDSA 서명 알고리즘을 사용하여 자신의 개인키로 서명

이더리움 트랜잭션 유형
* 하나의 어카운트에서 다른 어카운트로 이더를 전송할떄
** from EOA ...




### Receipt
**트랜젝션의 실행과정에 대한 모든 기록**
* 트랜잭션과 관련된 실행환경과 검색을 위한 인덱싱 등 블록 내에 정상 등록된 모든 트랜잭션에 대한 정보들이 저장

리시트 구조
```go
type Receipt struct{
	PostState []byte //트랜잭션 처리후 상태정보
	Status uint

}

``


### Block
**이더리움에서 블록은 블록헤더, 엉클블록, 트랜잭션, 마이닝작업의 난이도로 구성
https://etherscan.io/block/5491846           <- 5491846번 블록정보




### Genesis Block
**제네시스 블록**
* 블록체인에서 첫번쨰에 위치한 최초 블록
* 블록넘버가 0으로 이전블록이 없음
* 어떤 트랜잭션도 포함하고있지 않음
* 동일한 제너시스 블록을 갖고있는 이더리움 클라이언트만 


**jenesis.json**
* 블록체인의 Genesis 블록 (0번째블록)의 정보가 저장된 JSON 형식의 텍스트 파일
* 프라이빅 이더리움 네트워크 구축시 사용

config: 제너시스 블록의 설정값을 정의
chainId: 블록체인을 식별하는 값
homesteadBlock



### Uncle Block
**엉클블록**(Uncle Block)
* 블록생성에 성공하였고 검증에 오류가 없어서 이더리움 네트워크를 통해 다른노드레 브로드캐스팅은 되었으나 다른 마이너가 생성한 다른 블록에 비해 난이도가 낮아 블록체인에는 등록되지 못한 블록
* 비트코인의 스테일블록(stale block), 고아블록(orphan block)

**엉클블록이 많아질경우 문제점**
* 엉클블록 내에 트랜잭션은 즉시 처리되지 않음 -> 트랜잭션 처리 지연
* 엉클블록뒤에 연결된 블록들은 불필요한 해시 계산을 위해 컴퓨팅 파워를 사용 -> 컴퓨팅 파워 낭비
* 엉클블록 생성후 다음 블록을 생성하면 평균블록 생성시간이 길어지므로 난이도가 감소 -> 컴퓨팅 파워가 큰 마이너의 영향력이 커지는 보안문제가 발생


### GHOST
Greedy Heaciest Observed SubTree

**Ghost 프로토콜**
* 비트코인의 성능 및 보안성 향상을 위해 나온 알고리즘
* 성능과 보안성은 스테일 블록 생성 확률에 반비례
* 비트코인
 * 길이가 더 긴 블록을 메인 체인으로 채택하고 스테일 블록을 제거
 * 블록 생성주기(10분)가 길어서 스테일 블록 생성 확률이 낮음


**수정 Ghost 프로토콜**
* 이더리움 -> 블록 생성주기 (13초)가 짧아서 분기(fork)가 빈번하게 발생
* 포크가 발생했을떄 각 체인에 묶인 블록들의 생성난이도 전체를 더한 결과가 가장 높은 체인을 메인 체인으로 채택(엉클블록의 난이도를 포함)
* 블록 생성시 정상 블록에 최대 2개의 엉클블록까지 추가하고 보상
* 블록의 마이너 보상 = 블록보상+트랜잭션 수수료 + 엉클블록 한개당 블록보상의 3.123%
-

### 이더리움 클라이언트
*블록체인 네트워크의 노드
* 일반 사용자의 접속을 허용하고 블록체인과 연결시켜주는 역할

이 노드에는 사용자가 접속 가능
각각 네트워크


### 이더리움 네트워크
메인 네트워크
* 공개형 블록체인으로 누구나 계정 및 트랜잭션 생성, 계약 배포, 합의 참가 등이 가능
* 초키의 프론티어 에서 홈스테스, 비잔티움으로 발전
* 네트워크 상태 확인 링크 -> ethstats.net     etherscan.io    etherchian.org

**테스트 네트워크**
* 메인 네트워크를 완벽히 복제한것으로 스마트 컨트랙트를 배포, 사용하는데 비용이 들지 않음 
*롭스텐(): 작업증명(PoW) 합의 알고리즘 사용. 예전엔 모르덴(Modern)으로 불림
* 링키비(): 권한증명(PoW) 합의 알고리즘 사용. 이더리움 재단에서 운영
* 코반(Kovan): 권한증명(PoA) 한의 알고리즘 사용. 러스트 기반의 이더리움 클라이언트


**사설 네트워크**
* 하나의 노드 또는 한정된 노드만 ㅊ참가할수있는 사설 테스트 네트워크
* 채울의 난이도를 지정할수 있으므로 참가하는 노드가 쉽게 채굴할수 있음 (채굴로 획득한 이더는 새당사설네트워크에서만 사용가능)


### 이더
* 이더리움 내부 화폐 단위
* 암호화쳬로 주고받을수도 잇고, 계약을 수행하는 수수료로도 이용
converter.murkin.me



커뮤니티 활성화 -> 마이너로 참여 -> 노드가 많아짐 -> 안정적
**네트워크도 중요하지만 어떤 서비스를 만들어서 사람들의 관심을 갖게 할것인지도 중요**


**마이크로페이먼트**
단위를 낮추는것
현물의 화폐라는것은 증표할수있는것이 필요한데
동전에 표기되어있는 동전의 금액보다 그것을 만드는데 더 많은 금액이 들기때문에 단위를 낮추기 쉽지않지만 프로그램은 숫자이기때문에 가능
wei 가 가장 작은 이더 단위

### 가스
*Ether의 송금과 계약을 실행하기위해 지불하는 수수료
* 이더리움의 이용자는 사용한 컴퓨팅 자원의 대가로 채굴자에게 Gas를 지불
* 지불하는 Gas는 요구하는 자원의 양과 복잡성으로 결정되는 수수료(Gas Fee)와 현재 가스 가격(Gas Price)에 의해 결정

**수수료**(gas Fee)
* 이더리움에서 요구하는 자원의 양과 복잡도에 띠라 가치가 결정되는 수수료
* 소비한 가스에 가스 금액(gas price)을 곱한 액수를 채굴자에게 수수료로 지급
* 단위: Gas

**가스 가격**(Gas Price)
* 1gas당 가격
* 단위 : Wei/Gas

**가스 한도** (Gas Limit)
* 거래를 발생할때 사용할 가스의 최대 소비량
* 과다한 수수료 지출을 방지 및 서비스 거부 공격 방지



## Geth
### Geth 인터페이스별 명령어 종류
**Commend Line Options**
* xjal터미널에서 실행하는Geth 명령어와 옵션

**JavaScript Console**
* 전체 web3

**Management APIs**
* a

**JSON-RPC server**
* 다양한 호출방식을 제공
























